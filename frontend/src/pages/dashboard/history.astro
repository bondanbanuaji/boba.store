---
import Dashboard from "../../layouts/Dashboard.astro";
import { Package, Search, Filter, ChevronLeft, ChevronRight } from "lucide-astro";
import { formatCurrency, formatDate } from "../../lib/utils";

// TODO: Fetch from API with pagination
const orders = [
  { id: 'ORD-001', product: 'Mobile Legends', item: '86 Diamonds', status: 'completed', amount: 25000, date: '2024-01-15T10:30:00' },
  { id: 'ORD-002', product: 'Free Fire', item: '100 Diamonds', status: 'pending', amount: 15000, date: '2024-01-14T14:20:00' },
  { id: 'ORD-003', product: 'PUBG Mobile', item: '60 UC', status: 'completed', amount: 16000, date: '2024-01-13T09:15:00' },
  { id: 'ORD-004', product: 'Genshin Impact', item: '300 Genesis Crystals', status: 'completed', amount: 75000, date: '2024-01-12T16:45:00' },
  { id: 'ORD-005', product: 'Mobile Legends', item: '172 Diamonds', status: 'failed', amount: 48000, date: '2024-01-11T11:00:00' },
];

const statusColors = {
  pending: 'text-yellow-400 bg-yellow-400/10',
  processing: 'text-blue-400 bg-blue-400/10',
  completed: 'text-green-400 bg-green-400/10',
  failed: 'text-red-400 bg-red-400/10',
};

const statusLabels = {
  pending: 'Pending',
  processing: 'Diproses',
  completed: 'Selesai',
  failed: 'Gagal',
};
---

<Dashboard title="Riwayat Transaksi - Boba.Store">
  <div class="space-y-8">
    <!-- Header -->
    <div>
      <h1 class="text-3xl font-bold text-white">Riwayat Transaksi</h1>
      <p class="text-white/60 mt-1">Lihat semua riwayat transaksi Anda.</p>
    </div>

    <!-- Filters -->
    <div class="glass rounded-2xl p-4">
      <div class="flex flex-col md:flex-row gap-4">
        <div class="flex-1 relative">
          <Search class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-white/40" />
          <input
            type="text"
            placeholder="Cari ID pesanan atau produk..."
            class="w-full bg-black/20 border border-white/10 rounded-xl pl-12 pr-4 py-3 text-white placeholder:text-white/40 focus:outline-none focus:border-[var(--color-primary)] transition-colors"
          />
        </div>
        <select class="bg-black/20 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-[var(--color-primary)] transition-colors min-w-[150px]">
          <option value="" class="bg-[var(--color-background)]">Semua Status</option>
          <option value="pending" class="bg-[var(--color-background)]">Pending</option>
          <option value="processing" class="bg-[var(--color-background)]">Diproses</option>
          <option value="completed" class="bg-[var(--color-background)]">Selesai</option>
          <option value="failed" class="bg-[var(--color-background)]">Gagal</option>
        </select>
      </div>
    </div>

    <!-- Orders Table -->
    <div class="glass rounded-2xl overflow-hidden">
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead>
            <tr class="text-left text-white/60 text-sm border-b border-white/10 bg-black/20">
              <th class="px-6 py-4 font-medium">ID Pesanan</th>
              <th class="px-6 py-4 font-medium">Produk</th>
              <th class="px-6 py-4 font-medium">Item</th>
              <th class="px-6 py-4 font-medium">Status</th>
              <th class="px-6 py-4 font-medium">Tanggal</th>
              <th class="px-6 py-4 font-medium text-right">Total</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-white/5">
            {orders.map(order => (
              <tr class="hover:bg-white/5 transition-colors">
                <td class="px-6 py-4">
                  <a href={`/track?id=${order.id}`} class="text-[var(--color-primary)] hover:underline font-medium">
                    {order.id}
                  </a>
                </td>
                <td class="px-6 py-4 text-white">{order.product}</td>
                <td class="px-6 py-4 text-white/70">{order.item}</td>
                <td class="px-6 py-4">
                  <span class={`px-3 py-1 rounded-full text-xs font-medium ${statusColors[order.status]}`}>
                    {statusLabels[order.status]}
                  </span>
                </td>
                <td class="px-6 py-4 text-white/70 text-sm">{formatDate(order.date)}</td>
                <td class="px-6 py-4 text-right text-white font-medium">{formatCurrency(order.amount)}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      {orders.length === 0 && (
        <div class="text-center py-16">
          <Package class="w-16 h-16 text-white/20 mx-auto mb-4" />
          <h3 class="text-xl font-bold text-white mb-2">Belum Ada Transaksi</h3>
          <p class="text-white/60 mb-6">Mulai top up game favoritmu sekarang!</p>
          <a href="/products" class="inline-flex px-6 py-3 rounded-full bg-[var(--color-primary)] text-white font-bold hover:brightness-110 transition-all">
            Mulai Top Up
          </a>
        </div>
      )}

      <!-- Pagination -->
      {orders.length > 0 && (
        <div class="px-6 py-4 border-t border-white/10 flex items-center justify-between">
          <p class="text-sm text-white/60">Menampilkan 1-5 dari 24 transaksi</p>
          <div class="flex items-center gap-2">
            <button class="p-2 rounded-lg glass glass-hover text-white/70 hover:text-white disabled:opacity-50" disabled>
              <ChevronLeft class="w-5 h-5" />
            </button>
            <button class="px-4 py-2 rounded-lg bg-[var(--color-primary)] text-white font-medium">1</button>
            <button class="px-4 py-2 rounded-lg glass glass-hover text-white/70 hover:text-white">2</button>
            <button class="px-4 py-2 rounded-lg glass glass-hover text-white/70 hover:text-white">3</button>
            <button class="p-2 rounded-lg glass glass-hover text-white/70 hover:text-white">
              <ChevronRight class="w-5 h-5" />
            </button>
          </div>
        </div>
      )}
    </div>
  </div>
</Dashboard>
